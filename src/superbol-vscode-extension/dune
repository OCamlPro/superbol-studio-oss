; generated by drom from package skeleton 'driver'
(executable
  (name main)
  ; use field 'dune-libraries' to add libraries without opam deps
  (libraries vscode js_of_ocaml gen_js_api )
  (flags (:standard))
  ; use field 'dune-stanzas' to add more stanzas here
  (preprocess (pps gen_js_api.ppx js_of_ocaml-ppx))
  (modes js)
(js_of_ocaml
  (flags --source-map --pretty))

  )

; Use `static-clibs` to specify static C libs (without lib prefix)
; and `static-macos-clibs` and `static-alpine-clibs` for system specific deps
(rule
  (targets linking.sexp)
  (enabled_if (<> %{ocaml-config:system} mingw64))
  (deps (file linking_flags.sh))
  (action  (with-stdout-to %{targets}
    (run bash linking_flags.sh linking.sexp %{env:LINKING_MODE=dynamic} %{ocaml-config:system} ))))

(rule
  (targets linking.sexp)
  (enabled_if (= %{ocaml-config:system} mingw64))
  (deps (file linking_flags.sh))
  (action  (with-stdout-to %{targets}
    (run bash -c "echo '()' > linking.sexp"))))


(rule
    (targets version.ml)
    (deps (:script version.mlt) package.toml)
    (action (with-stdout-to %{targets} (run %{ocaml} unix.cma %{script}))))

(documentation
  (package superbol-vscode-extension))

; use field 'dune-trailer' to add more stuff here

